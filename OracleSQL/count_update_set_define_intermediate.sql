--error row count, execute before and after.

SELECT FILE_NAME, COUNT (*) FROM DF_TBC_SPEND_FINAL
WHERE FILE_NAME IN
(
    'TBC_NONPO_04012023-04012023_FY23-APR',
    'TBC_NONPO_06012023-06012023_FY23-JUN',
    'TBC_NONPO_05012023-05012023_FY23-MAY',
    'TBC_GNFRPO_06012023-06012023_FY23-JUN',
    'TBC_GNFRPO_04012023-04012023_FY23-APR',
    'TBC_GNFRPO_05012023-05012023_FY23-MAY'
)
GROUP BY FILE_NAME;



--first disable the substitution variable prompt
SET DEFINE OFF;

--perform the UPDATE 
UPDATE DF_TBC_SPEND_FINAL
SET FILE_NAME =
    CASE FILE_NAME 
        WHEN 'TBC_NONPO_04012023-04012023_FY23-APR' THEN 'TBC_NONPO_04012023-04302023_FY23-APR'
        WHEN 'TBC_NONPO_06012023-06012023_FY23-JUN' THEN 'TBC_NONPO_06012023-06302023_FY23-JUN'
        WHEN 'TBC_NONPO_05012023-05012023_FY23-MAY' THEN 'TBC_NONPO_05012023-05312023_FY23-MAY'
        WHEN 'TBC_GNFRPO_06012023-06012023_FY23-JUN' THEN 'TBC_GNFRPO_06012023-06302023_FY23-JUN'
        WHEN 'TBC_GNFRPO_05012023-05012023_FY23-MAY' THEN 'TBC_GNFRPO_05012023-05312023_FY23-MAY'
        WHEN 'TBC_GNFRPO_04012023-04012023_FY23-APR' THEN 'TBC_GNFRPO_04012023-04302023_FY23-APR'
        ELSE FILE_NAME
    END
WHERE FILE_NAME IN
(
    'TBC_NONPO_04012023-04012023_FY23-APR',
    'TBC_NONPO_06012023-06012023_FY23-JUN',
    'TBC_NONPO_05012023-05012023_FY23-MAY',
    'TBC_GNFRPO_06012023-06012023_FY23-JUN',
    'TBC_GNFRPO_04012023-04012023_FY23-APR',
    'TBC_GNFRPO_05012023-05012023_FY23-MAY'
);
    
COMMIT;

--enable the substitution variable prompt again
SET DEFINE ON; 
